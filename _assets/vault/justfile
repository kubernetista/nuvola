# Justfile

# Variables
# EXAMPLE_VAR := "example"

# List ğŸ“œ all recipes (default)
help:
    @just --list

# Start Vault ğŸ” and detach ğŸ«¥
vault-start:
    @docker compose -f compose.yaml up --detach

alias start := vault-start

# Start Vault ğŸ” and stay attached to the console/logs
vault-start-attached:
    @docker compose -f compose.yaml up

# Start Vault ğŸ” and detach ğŸ«¥
vault-stop:
    @docker compose -f compose.yaml down

alias stop := vault-stop

# Get the Vault root token and unseal keys (âš ï¸ save them, as can it be executed only once!)
vault-init:
    #@-VAULT_ADDR='http://127.0.0.1:8200' vault operator init
    @-docker exec -it vault vault operator init

# Unseal the Vault
vault-unseal:
    @echo "\nğŸ”’ Unseal Vault - step 1/3"
    @-docker exec -it vault vault operator unseal
    @echo "\nğŸ”’ Unseal Vault - step 2/3"
    @-docker exec -it vault vault operator unseal
    @echo "\nğŸ”’ Unseal Vault - step 3/3"
    @-docker exec -it vault vault operator unseal
    @echo "\nğŸ”“ Now login to Vault"
    @-docker exec -it vault vault login
    @echo "\nğŸ”‘ Vault status"
    @-docker exec -it vault vault status

alias unseal := vault-unseal

# vault logs
vault-logs:
    @tail -f volumes/logs/vault.log

alias logs := vault-logs
